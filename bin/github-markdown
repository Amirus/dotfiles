#!/usr/bin/env ruby -rubygems -w
old_level, $-w = $-w, nil
begin
  require 'pygments'
  require 'redcarpet'
ensure
  $-w = old_level
end

class HTMLwithAlbino < Redcarpet::Render::HTML
  def block_code(code, language)
    Pygments.highlight(code, :lexer => language)
  end
end

markdown = Redcarpet::Markdown.new \
  HTMLwithAlbino.new(:filter_html => true),
  :autolink => true, :no_intra_emphasis => true, :fenced_code_blocks => true

puts markdown.render(ARGF.read)
